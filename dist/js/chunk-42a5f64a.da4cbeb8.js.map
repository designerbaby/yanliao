{"version":3,"sources":["webpack:///./src/api/draft.js","webpack:///./src/api/api.js","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/views/Main/rectify.vue?0463","webpack:///src/views/Main/rectify.vue","webpack:///./src/views/Main/rectify.vue?cd29","webpack:///./src/views/Main/rectify.vue","webpack:///./src/assets/3.png","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/views/Main/rectify.vue?9862"],"names":["axios","service","addDraft","data","method","url","deleteDraft","draftId","draft_id","fetchDraftDetailById","search","param","params","editInfo","arrangeId","songDetail","musicId","songOtherDetail","preSubmit","form","submit","melodyConfig","singer","$","$find","find","addToUnscopables","arrayMethodUsesToLength","FIND","SKIPS_HOLES","USES_TO_LENGTH","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","_m","_v","_l","line","lineIndex","key","content","from","char","charIndex","class","polyphonicMap","_s","item","model","on","$event","radioClick","directives","name","rawName","value","expression","attrs","domProps","_q","$set","radioChange","_e","prevButtonClick","confirmButtonClick","staticRenderFns","components","Header","submitSuccess","oldForm","lyricList","polyphonicList","created","getDraftInfo","getDefaultInfo","mounted","window","onbeforeunload","isModified","destroyed","methods","JSON","parse","sessionStorage","getItem","console","log","initFormData","d","arrange_id","new_lyric_list","initPolyphonicMap","defaultForm","getFormData","forEach","options","l","setItem","v","x","y","pinyin","o","stringify","formData","comparisonFormData","currentForm","submitDraft","step","fix_pinyin_list","f","id","$forceUpdate","editPath","$router","push","music_id","ret_code","Message","error","response","err_msg","component","module","exports","$map","map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT"],"mappings":"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","file":"js/chunk-42a5f64a.da4cbeb8.js","sourcesContent":["// 草稿功能相关api\nimport service from './main'\n\nconst axios = service\n\n// 添加或修改草稿箱\nconst addDraft = (data) => {\n  return axios({\n    method: 'post',\n    url: '/cgi-bin/v1/yan/synth/modify_audio_draft',\n    data,\n  })\n}\n\n// 删除草稿箱 \nconst deleteDraft = (draftId) => {\n  return axios({\n    method: 'post',\n    url: '/cgi-bin/v1/yan/synth/del_audio_draft',\n    data: {\n      draft_id: draftId,\n    },\n  })\n}\n\n// 拉取草稿箱详情\nconst fetchDraftDetailById = (draftId) => {\n  return axios({\n    method: 'post',\n    url: '/cgi-bin/v1/yan/synth/get_audio_draft_detail',\n    data: {\n      draft_id: draftId,\n    },\n  })\n}\n\nexport {\n  addDraft,\n  deleteDraft,\n  fetchDraftDetailById,\n}","import service from '@/api/main'\n\nconst axios = service\n\n// 搜索歌曲列表\nconst search = (param) => {\n  return axios({\n    method: 'get',\n    url: '/cgi-bin/musicx/kuwa/search_music',\n    params: param,\n  })\n}\n\n// 查询歌曲的编辑信息\nconst editInfo = (arrangeId) => {\n  return axios({\n    method: 'get',\n    url: '/cgi-bin/musicx/kuwa/get_music_edit_detail',\n    params: {\n      'arrange_id': arrangeId,\n    },\n  })\n}\n\n// 查询歌曲的合成状态\nconst songDetail = (musicId) => {\n  return axios({\n    method: 'get',\n    url: '/cgi-bin/musicx/kuwa/get_music_info',\n    params: {\n      'music_id': musicId,\n    },\n  })\n}\n\n// 查询歌曲的其他信息\nconst songOtherDetail = (musicId) => { \n  return axios({\n    method: 'get',\n    url: '/cgi-bin/musicx/kuwa/get_music_ext_info',\n    params: {\n      'music_id': musicId,\n    },\n  })\n}\n\n// 预提交改编歌曲\nconst preSubmit = (form) => {\n  return axios({\n    method: 'post',\n    url: '/cgi-bin/musicx/kuwa/pre_arrange_music',\n    data: form,\n  })\n}\n\n// 提交改编歌曲\nconst submit = (form) => {\n  return axios({\n    method: 'post',\n    url: '/cgi-bin/musicx/kuwa/arrange_music',\n    data: form,\n  })\n}\n\n// 查询歌曲合成的任务状态\nconst downloadStatus = (arrangeId) => {\n  return axios({\n    method: 'get',\n    url: '/cgi-bin/musicx/kuwa/get_music_arrange_info',\n    params: {\n      'arrange_id': arrangeId,\n    },\n  })\n}\n\n// 获取音源曲调\nconst melodyConfig = (musicId, singer) => {\n  return axios({\n    method: 'get',\n    url: '/cgi-bin/musicx/kuwa/tone',\n    params: {\n      'music_id': musicId,\n      'singer': singer,\n    },\n  })\n}\n\nexport {\n  search,\n  editInfo,\n  songDetail,\n  songOtherDetail,\n  preSubmit,\n  submit,\n  downloadStatus,\n  melodyConfig,\n}","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"re-edit-page\"},[_vm._m(0),_c('div',{staticClass:\"tips\"},[_vm._v(\"您的歌词中含有多音字（标红显示），请确保下面每个字对应的拼音是正确的\")]),_c('div',{staticClass:\"lyric\"},_vm._l((_vm.lyricList),function(line,lineIndex){return _c('div',{key:line.content + lineIndex,staticClass:\"item\"},_vm._l((Array.from(line.content)),function(char,charIndex){return _c('span',{key:char + charIndex},[_c('span',{class:_vm.polyphonicMap[lineIndex] && _vm.polyphonicMap[lineIndex][charIndex] ? 'strong' : ''},[_vm._v(_vm._s(char))]),(_vm.polyphonicMap[lineIndex] && _vm.polyphonicMap[lineIndex][charIndex])?_c('span',{staticClass:\"pinyin-selector-box\"},[_c('span',{staticClass:\"bracket\"},[_vm._v(\"[\")]),_vm._l((_vm.polyphonicMap[lineIndex][charIndex].options),function(item){return _c('span',{key:item + charIndex,class:_vm.polyphonicMap[lineIndex][charIndex].model === item ? 'selected' : ''},[_c('span',{staticClass:\"radio-icon\",on:{\"click\":function($event){return _vm.radioClick(lineIndex, charIndex, item)}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.polyphonicMap[lineIndex][charIndex].model),expression:\"polyphonicMap[lineIndex][charIndex].model\"}],attrs:{\"type\":\"radio\",\"name\":char + lineIndex + charIndex,\"hidden\":\"\"},domProps:{\"value\":item,\"checked\":_vm._q(_vm.polyphonicMap[lineIndex][charIndex].model,item)},on:{\"change\":[function($event){return _vm.$set(_vm.polyphonicMap[lineIndex][charIndex], \"model\", item)},_vm.radioChange]}}),_c('span',{staticClass:\"pinyin\",on:{\"click\":function($event){return _vm.radioClick(lineIndex, charIndex, item)}}},[_vm._v(_vm._s(item))])])}),_c('span',{staticClass:\"bracket\"},[_vm._v(\"]\")])],2):_vm._e()])}),0)}),0),_c('div',{staticClass:\"footer\"},[_c('button',{staticClass:\"main-button\",on:{\"click\":_vm.prevButtonClick}},[_vm._v(\"上一步\")]),_c('button',{staticClass:\"main-button\",on:{\"click\":_vm.confirmButtonClick}},[_vm._v(\"完成\")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page-title\"},[_c('img',{staticClass:\"step\",attrs:{\"src\":require(\"@/assets/3.png\"),\"alt\":\"\"}}),_c('div',{staticClass:\"text\"},[_vm._v(\"校正歌词\")])])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"re-edit-page\">\n    <div class=\"page-title\">\n      <img class=\"step\" src=\"@/assets/3.png\" alt=\"\"/>\n      <div class=\"text\">校正歌词</div>\n    </div>\n    <div class=\"tips\">您的歌词中含有多音字（标红显示），请确保下面每个字对应的拼音是正确的</div>\n    <div class=\"lyric\">\n      <div class=\"item\" v-for=\"(line, lineIndex) in lyricList\" :key=\"line.content + lineIndex\">\n        <span v-for=\"(char, charIndex) in Array.from(line.content)\" :key=\"char + charIndex\">\n          <span :class=\"polyphonicMap[lineIndex] && polyphonicMap[lineIndex][charIndex] ? 'strong' : ''\">{{ char }}</span>\n          <span class=\"pinyin-selector-box\" v-if=\"polyphonicMap[lineIndex] && polyphonicMap[lineIndex][charIndex]\">\n            <span class=\"bracket\">[</span>\n            <span v-for=\"item in polyphonicMap[lineIndex][charIndex].options\" :key=\"item + charIndex\" :class=\"polyphonicMap[lineIndex][charIndex].model === item ? 'selected' : ''\">\n              <span class=\"radio-icon\" @click=\"radioClick(lineIndex, charIndex, item)\"></span>\n              <input type=\"radio\" :name=\"char + lineIndex + charIndex\" :value=\"item\" v-model=\"polyphonicMap[lineIndex][charIndex].model\" @change=\"radioChange\" hidden>\n              <span class=\"pinyin\" @click=\"radioClick(lineIndex, charIndex, item)\">{{ item }}</span>\n            </span>\n            <span class=\"bracket\">]</span>\n          </span>\n        </span>\n      </div>\n    </div>\n    <div class=\"footer\">\n      <button @click=\"prevButtonClick\" class=\"main-button\">上一步</button>\n      <button @click=\"confirmButtonClick\" class=\"main-button\">完成</button>\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport {\n  preSubmit,\n  submit,\n} from '@/api/api'\n\nimport { \n  addDraft,\n  fetchDraftDetailById,\n  deleteDraft,\n} from \"@/api/draft\"\n\nimport Header from '@/common/components/Header.vue'\nimport { reportEvent } from '@/common/utils/helper'\n\nexport default {\n  name: 'Home',\n  components: {\n    Header,\n  },\n  data() {\n    return {\n      submitSuccess: false,\n      oldForm: {},\n      lyricList: [],\n      polyphonicList: [],\n      polyphonicMap: {},\n    }\n  },\n  created() {\n    const draftId = sessionStorage.getItem('draftId')\n    if (draftId) {\n      // 获取草稿数据\n      this.getDraftInfo(draftId)\n    } else {\n      // 获取默认数据\n      this.getDefaultInfo()\n    }\n  },\n  mounted() {\n    reportEvent('edit-page-2-exposure')\n    window.onbeforeunload = (event) => {\n      const isModified = this.comparisonFormData()\n      if (isModified === true) {\n        this.submitDraft()\n        return '您可能有数据没有保存'\n      }\n    }\n  },\n  destroyed() {\n    window.onbeforeunload = null\n  },\n  methods: {\n    getDefaultInfo() {\n      this.oldForm = JSON.parse(sessionStorage.getItem('form'))\n      console.log('getDefaultInfo this.oldForm:', this.oldForm)\n      this.polyphonicList = JSON.parse(sessionStorage.getItem('polyphonicList'))\n      this.initFormData()\n    },\n    getDraftInfo(draftId) {\n      fetchDraftDetailById(draftId).then((response) => {\n        const { data } = response.data\n        const d = data.audio_draft_info.content\n        d.arrange_id = this.$route.query.arrangeId || undefined\n        this.oldForm = d\n        return preSubmit(d)\n      }).then((response) => {\n        const { data } = response.data\n        this.polyphonicList = data.polyphonic_list\n        console.log('fetchDraftDetailById this.polyphonicList:', this.polyphonicList)\n        this.initFormData()\n      })\n    },\n    initFormData() {\n      this.lyricList = this.oldForm.new_lyric_list\n      this.initPolyphonicMap()\n      this.defaultForm = this.getFormData()\n    },\n    // 初始化多音字表单对象\n    initPolyphonicMap() {\n      this.polyphonicList.forEach((item) => {\n        const x = item.x\n        const y = item.y\n        const l = item.pinyin_list\n        if (!this.polyphonicMap[x]) {\n          this.polyphonicMap[x] = {}\n        }\n        this.polyphonicMap[x][y] = {\n          options: l,\n          // model: l[0],\n        }\n        if (this.oldForm.fix_pinyin_list && this.oldForm.fix_pinyin_list.length !== 0) {\n          this.polyphonicMap[x][y].model = this.oldForm.fix_pinyin_list.filter((i) => i.x === x).find((i) => i.y === y).pinyin || ''\n        } else {\n          this.polyphonicMap[x][y].model = l[0]\n        }\n      })\n    },\n    // 删除草稿数据\n    deleteDraft() {\n      const draftId = sessionStorage.getItem('draftId')\n      deleteDraft(draftId)\n      sessionStorage.setItem('draftId', '')\n    },\n    // 获取表单数据\n    getFormData() {\n      const formData = this.polyphonicList.map((item) => {\n        const x = item.x\n        const y = item.y\n        if (this.polyphonicMap[x][y]) {\n          let v = ''\n          if (this.polyphonicMap[x][y].model) {\n            v = this.polyphonicMap[x][y].model\n          }\n          const o = {\n            x,\n            y,\n            pinyin: v,\n          }\n          return o\n        }\n      })\n      return JSON.stringify(formData)\n    },\n    comparisonFormData() {\n      const defaultForm = this.defaultForm\n      const currentForm = this.getFormData()\n      let isModified = false\n      if (defaultForm !== currentForm) {\n        isModified = true\n      }\n      return isModified\n    },\n    submitDraft() {\n      const oldForm = this.oldForm\n      const draftId = sessionStorage.getItem('draftId')\n      const f = Object.assign({}, oldForm, {\n        step: 2,\n        draft_id: draftId || '',\n        fix_pinyin_list: JSON.parse(this.getFormData()),\n      })\n      console.log('submitDraft f:', f)\n      addDraft(f).then((response) => {\n        const { data } = response.data\n        const id = data.draft_id\n        sessionStorage.setItem('draftId', id)\n      })\n    },\n    radioClick(lineIndex, charIndex, item) {\n      this.polyphonicMap[lineIndex][charIndex].model = item\n      this.$forceUpdate()\n    },\n    radioChange() {\n      // 多音字编辑页-拼音修正次数\n      reportEvent(\"edit-page-2-polyphoic-update\")\n      this.$forceUpdate()\n    },\n    prevButtonClick() {\n      // 多音字编辑页-上一步按钮-点击\n      reportEvent(\"edit-page-2-prev-button\")\n      let editPath = sessionStorage.getItem('editPath')\n      console.log('editPath:', editPath)\n      if (editPath) {\n        this.$router.push(JSON.parse(editPath))\n      } else {\n        // debugger\n        this.$router.push('/edit/' + this.oldForm.music_id)\n      }\n      // this.$router.go(-1)\n    },\n    confirmButtonClick() {\n      // 多音字编辑页-确认按钮-点击\n      reportEvent(\"edit-page-2-confirm-button\")\n      const f = this.oldForm\n      f.fix_pinyin_list = JSON.parse(this.getFormData())\n      log('rectify confirmButtonClick 提交数据：', f)\n      submit(f).then((response) => {\n        const { data, ret_code } = response.data\n        if (ret_code === 0) {\n          this.deleteDraft()\n          this.submitSuccess = true\n          this.$router.push(`/profile`)\n        } else {\n          Message.error(response.data.err_msg)\n        }\n      })\n    },\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n  .re-edit-page {\n    .page-title {\n      padding: 0px 0 0 94px;\n      display: flex;\n      align-items: flex-end;\n      .text {\n        height: 38px;\n        line-height: 38px;\n        color: #000;\n        font-size: 38px;\n        margin-left: 10px;\n      }\n    }\n    .tips {\n      font-size: 20px;\n      color: #979797;\n      margin: 22px 0 0 150px;\n    }\n    .lyric {\n      margin: 40px 0 0 150px;\n      color: #000;\n      font-size: 0px;\n      .item {\n        margin-top: 22px;\n        font-size: 0px;\n        .strong {\n          color: #e02020;\n        }\n        .pinyin-selector-box {\n          .bracket {\n            color: #e02020;\n            margin: 0 1px;\n          }\n          .pinyin {\n            color: #979797;\n            cursor: pointer;\n          }\n          .radio-icon {\n            width: 14px;\n            height: 14px;\n            border: 1px solid #979797;\n            border-radius: 50%;\n            margin: 0 4px;\n            position: relative;\n            cursor: pointer;\n          }\n          .selected {\n            .pinyin {\n              color: #e02020;\n            }\n            .radio-icon {\n              border-color: #e02020;\n            }\n            .radio-icon::after {\n              content: '';\n              position: absolute;\n              top: 50%;\n              left: 50%;\n              transform: translate(-50%, -50%);\n              width: 8px;\n              height: 8px;\n              background: #e02020;\n              border-radius: 50%;\n            }\n          }\n        }\n        span {\n          font-size: 18px;\n          display: inline-block;\n        }\n      }\n    }\n    .footer {\n      display: flex;\n      justify-content: center;\n      padding: 0 0 114px 0;\n      margin: 78px 0 0 0;\n      .main-button {\n        width: 200px;\n        height: 40px;\n        color: #fff;\n        font-weight: 500;\n        border-radius: 40px;\n        background: linear-gradient(to right, #44b5ff, #79d2ff);\n        display: block;\n        font-size: 18px;\n      }\n      .main-button + .main-button {\n        margin-left: 40px;\n      }\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rectify.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rectify.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./rectify.vue?vue&type=template&id=912efc80&scoped=true&\"\nimport script from \"./rectify.vue?vue&type=script&lang=js&\"\nexport * from \"./rectify.vue?vue&type=script&lang=js&\"\nimport style0 from \"./rectify.vue?vue&type=style&index=0&id=912efc80&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"912efc80\",\n  null\n  \n)\n\nexport default component.exports","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAsCAMAAAAtr3oOAAAAkFBMVEUAAAAurv8srP9Dxf8sq/8sq/8tq/8srP8srP8urf8trP8ytv8trf8urf8wrv9M4/8srP8tq/8sq/8srP8srP8srP8srP8trP8trP8srP8trP8trP8srP8tq/8srf8srP8trf8xsv8ys/8srP8srP8srP8srP8sq/8trP8urP8trv8srP8vrP8srP8trv8sq/+7WJ8cAAAAL3RSTlMAK+0H+/Pl2r1WTwxlQRcD9+nW0babl3h04M2wp4+JbFsbE8jCraKVcUUygzncXwCFx2UAAAGqSURBVEjHjZXZkoIwEEUju+wgiyACiqC45f//bmrSpMAkaM7b3JzqGrvbFs088ySONN2ID7kXoO+orokXGA//m303MYPyXrddDfOkqzYWkoltm76Hl7TOkjikf9si2zHgMWocCM43HZJCFehHeOsWvdjoq+UdeCrOy7ABfeD1Fl62nyk01uT1HubCpFeS6rwOda5MmmOCyk0fJuQy8R5Gy3/SLcEXtqtEkuyIXknaHiZ4cvapIPZFzrYNaOP9R1HPG233+pp2iLP57s1YGySvH54QSeqxq8rqgNL80scsS6ukwBOpKtf1XAHfCpAU/gX8B5LDgZ0JfUl/hPI3JEkE7WfjDeHE6QnRd2wM29Rzegr3gY2tla/NIK6ekVhz2BxambDxGxNaJj5r4qvqhHCAmIHXa1evx4JD40HxkP6Pah3r5f5/J54YOAazbStTRu1y3qFh8ruRjqKiO0zP7APPQ/YjPGFUdV4PL0zZzlcHsEg1BTOwC6PTevC7FwnkEL5NTHXocsXZ5Ya/x/Ph9XptKVufDQ8sbj/99tiZiqaYXdpyCxo0SXxoEfoD0FNwFFuW6YUAAAAASUVORK5CYII=\"","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n// FF49- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rectify.vue?vue&type=style&index=0&id=912efc80&lang=less&scoped=true&\""],"sourceRoot":""}