(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00a64d95"],{1148:function(t,e,n){"use strict";var r=n("a691"),i=n("1d80");t.exports="".repeat||function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},"114b":function(t,e,n){t.exports={audioEditor:"index_audioEditor_1_bvw",audioPlay:"index_audioPlay_1PJmd"}},"12f2":function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{methods:{focus:function(){this.$refs[t].focus()}}}}},1951:function(t,e,n){},2705:function(t,e,n){t.exports={container:"BeatLine_container_1pykc",isActive:"BeatLine_isActive_23xdL",line:"BeatLine_line_1MIiE",innerSpan:"BeatLine_innerSpan_3IKa9",inner:"BeatLine_inner_1mxDz"}},3046:function(t,e,n){t.exports={container:"BeatPiano_container_2Mex_",left:"BeatPiano_left_1-vXw",white:"BeatPiano_white_1E0jy",middle:"BeatPiano_middle_3RflJ",middleWhite:"BeatPiano_middleWhite_rC7Zi",middleBlack:"BeatPiano_middleBlack_1TqWH"}},"3b6e":function(t,e,n){t.exports={header:"BeatHeader_header_2UT1a",common:"BeatHeader_common_3S0Po",icon:"BeatHeader_icon_3O1k1",refresh:"BeatHeader_refresh_2UXB3",bpm:"BeatHeader_bpm_2a32Z",but:"BeatHeader_but_185gx",mode:"BeatHeader_mode_yzAmD",isActive:"BeatHeader_isActive_G-ZLD",text:"BeatHeader_text_2X4Xd"}},"408a":function(t,e,n){var r=n("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},"427c":function(t,e,n){t.exports={PitchLine:"PitchLine_PitchLine_28qgn"}},"43ab":function(t,e,n){"use strict";var r=n("3b6e"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},"4f35":function(t,e,n){t.exports={container:"Arrow_container_3MT2s",arrow:"Arrow_arrow_2Yi6b",right:"Arrow_right_1wIEH",left:"Arrow_left_30H2h",isActive:"Arrow_isActive_1aZHu"}},5712:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAdCAMAAAAaaVXxAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAl5QTFRFZGNfZmJkZ2NkSUVEAAAALi4uZWJiLSssZGJgSUVELy0uVVFRVVFRSUVEMC4vYl5dZ2NiYV5dVVVVSUVEZGFgYV5eZWFhZGBfS0lJUVFRLy0uLiwtLiwtZWJhLy0uZWFgZGFhZGJjX11eY2BfZmNiZmJiX11bLiwtKykqKScoSUVEMS8wY19eaGRlZmJjZmJhREFBKykqKigpSUVEYV1dZ2NjaGRjYFxbOTk5LiwtLi0rX1taY19eTUhISERDMi4tWlZVRkRENDIza2doSERDMCwrWVRTamRkZ2JiZ2JhYV1cOjg5MjAxMC4vZGJfSERDLSkqKykqMC4xLiwvMC4vLyssNC4uWVRUaWNjZmBgY2BfRDw8Ly0uZ2JjZ2FhZV9faGNiZWFgUklJZF9gZWBgYl5fZGBhYV5hX11fZWFiY19gZmFgaGNjZmFhaGJiUU1NYFxbX1tbYVxdYl5eYV5dXVlYX1paZGBgXFlYOzk6Ly0uaGNfTUhELyssMTA1MjEvYV1cSEZGLS0tKysrLCwsZ2NdTEdDX1xbNTU1MDAwZ2JeS0ZDLi0rXVpZNDQ0LS0tZ2JfSkRELSwxLi0rSkhHMDAwLi4uS0VFLSwxLy4sSUZGKysrKioqZmFiaGJkSkZHLSwxMCwtY19fUExMKScoLS0tKioqZ2JmSkVJLi4wLyssXVlZLiwtKysrZmFjSkVJLS0vMi4vYl5eQUFBKioqaGNpSENJMCwtYV1cR0RERUNILSssZWFfYV1dZ2RnR0VILy0uLiwtKykqSUdILy0uLSssZGNeYF9aODc1KiwrWIcQVwAAAMp0Uk5T////BwAH/wH/AQy/SAQD///9Gwv/////2j8CBA3/C//////////GDAEBCgL/////lQwBCP////0xAQH//jwPA/+VAf8lCv/////9JwIC/y4MCwYJBR5W////+CIE//////4c/////////////9X/vf///////////68I/y4EBV3/xRICBf8N/lsB/w4G/1sD/xECB+AJAQwLB1AMEP//CAMP/70DDhv/AgIG+zUL/wEECOozBP8BC/xPAQb7fP8BBjAIAgMC//8GAXEBeGUAAAIySURBVHicfdOFf9NAFAfwUI7i7GEdMCBIi5Ye0jsYboMWKQ49GCFDCqMjaBk+XIe7O8Xd3eW/4i53YSEdvM+n+eSX+35yLy+ppvGq4auJ3FULeUogze9TqbZ32a3q+OrKVK9+g/+phjI1yoPGTf6tmqrYrHkA8lu0bFXQOle1cVRbvV37Dh2DEOrUuUvXXNVNpu5h6BHxYQAc7tmrd47qo2IUCJAIoRSgb79Cj4qoefUfAKqEGzjI0/1gmYYMBYr5OlVu2PBClxoxUqqiUTA6RuNSiVuOGTtuvKMS/gkTJ02eMnXa9BmQZHxRV9vy38xZxY6ajZ0CY44NzD8HKJkrlTZv/oLUwkWli1m6jDEaZywG1OQmQikJACyRqgyA8BHwOVlGjBoGYwyEAkpSfP+lUsWXLV+xMroqmlmdtsBkSSuZ5DJGSWk5wJq162Rf6zdsRGgTQhWb+QCwYaQti+nyKWHL1m3bpdqxU41P5/3rhmmaBu+MTyy4a/ceZxLa3n0SVYob6PbDiaHC/gMHq6aaOHSYnx5B6KgclAGmvdux4yfc79E6yU9PIXQ6TywSQkVPJWeKbXL2nFTnL1zk6RJCl68QQkLlYjv96jXV6/UbSmVv8nQLods6UW/mzt2qr+uerRL3sw94eIjQIx1DIB+HHj9xf89P1T/t2XM7oBcYwvjlqwLkKVulsq9lepPBb995iaOC7z/I9PHT52qMUuD/ItPXb9Uiob7/wJmff1385VW/AZISihT6gxvaAAAAAElFTkSuQmCC"},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("1d80"),i=n("5899"),o="["+i+"]",a=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),c=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(a,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:c(1),end:c(2),trim:c(3)}},"67bb":function(t,e,n){"use strict";var r=n("4f35"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},"692c":function(t,e,n){"use strict";var r=n("427c"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},7577:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAAP1BMVEUAAAAsrP8srP8vrv8wsP8wrf8sq/8srP8tq/8trP8trP8tq/8srP8srP8trP8trP8trP8trP83tv9V1f8sq//5BkqYAAAAFHRSTlMA7tQ+LRr58uTdzcasopeBa1AOBnKoVFsAAABXSURBVBjTjdHJDsAgCEXRytBJO7///9Ym3RgiDd7lWRiB4T9Z06YtE4DpbBhfWVzGeDweA8SGa/vtMuarsqmoy0jsMpaI40eKBh8MxiHuXlWW6Az2aHEvDw0QI2n4PF4AAAAASUVORK5CYII="},"7dff":function(t,e,n){"use strict";var r=n("3046"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},"80bf":function(t,e,n){"use strict";var r=n("114b"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},"96cf":function(t,e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",l="object"===typeof t,u=e.regeneratorRuntime;if(u)l&&(t.exports=u);else{u=e.regeneratorRuntime=l?t.exports:{},u.wrap=S;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",g={},v={};v[a]=function(){return this};var m=Object.getPrototypeOf,y=m&&m(m(k([])));y&&y!==r&&i.call(y,a)&&(v=y);var b=x.prototype=w.prototype=Object.create(v);A.prototype=b.constructor=x,x.constructor=A,x[c]=A.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===A||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(b),t},u.awrap=function(t){return{__await:t}},P(L.prototype),L.prototype[s]=function(){return this},u.AsyncIterator=L,u.async=function(t,e,n,r){var i=new L(S(t,e,n,r));return u.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(b),b[c]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){while(e.length){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=k,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return s.type="throw",s.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),g}}}function S(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,o=Object.create(i.prototype),a=new C(r||[]);return o._invoke=$(t,n,a),o}function _(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}function w(){}function A(){}function x(){}function P(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function L(t){function e(n,r,o,a){var s=_(t[n],t,r);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"===typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(l).then((function(t){c.value=t,o(c)}),a)}a(s.arg)}var n;function r(t,r){function i(){return new Promise((function(n,i){e(t,r,n,i)}))}return n=n?n.then(i,i):i()}this._invoke=r}function $(t,e,n){var r=h;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return O()}n.method=i,n.arg=o;while(1){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=_(t,e,n);if("normal"===c.type){if(r=n.done?p:d,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}function E(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,E(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=_(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function B(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(B,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){while(++r<t.length)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},"990f":function(t,e,n){"use strict";var r=n("d8a6"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},"9ef1":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"audioEditor",class:t.$style.audioEditor},[n("BeatHeader",{attrs:{isPlaying:1==t.playState},on:{play:t.toPlay}}),n("BeatContainer",{ref:"BeatContainer",on:{showBeat:t.toShowBeat,getPitches:t.toGetPictData}}),n("BeatSelector",{ref:"BeatSelector"})],1)},i=[];n("99af"),n("4160"),n("159b"),n("96cf"),n("d3b7");function o(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(t){o(a,r,i,s,c,"next",t)}function c(t){o(a,r,i,s,c,"throw",t)}s(void 0)}))}}n("0fb7"),n("450d");var s=n("f529"),c=n.n(s),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Dialog",{attrs:{title:"编辑拍号",visible:t.dialogVisible,width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("Form",{ref:"ruleForm",attrs:{"label-position":"top",rules:t.rules,"label-width":"80px",model:t.beatForm}},[n("FormItem",{attrs:{label:"分子",prop:"fenzi"}},[n("InputNumber",{model:{value:t.beatForm.fenzi,callback:function(e){t.$set(t.beatForm,"fenzi",e)},expression:"beatForm.fenzi"}})],1),n("FormItem",{attrs:{label:"分母",prop:"fenmu"}},[n("InputNumber",{model:{value:t.beatForm.fenmu,callback:function(e){t.$set(t.beatForm,"fenmu",e)},expression:"beatForm.fenmu"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),n("Button",{attrs:{type:"primary"},on:{click:t.toSubmitBeat}},[t._v("确 定")])],1)],1)},u=[],h=n("5530"),d=(n("1951"),n("eedf")),f=n.n(d),p=(n("9d4c"),n("e450")),g=n.n(p),v=(n("eca7"),n("3787")),m=n.n(v),y=(n("425f"),n("4105")),b=n.n(y),S=(n("a7cc"),n("df33")),_=n.n(S),w=(n("caad"),function(t,e,n){var r=parseInt(e),i=/^\d+$/;!i.test(r)||r<1?n(new Error("必须为正整数")):n()}),A=function(t,e,n){var r=[2,4,8,16];r.includes(parseInt(e))?n():n(new Error("只能为2,4,8或16"))},x={name:"BeatSelector",components:{Dialog:_.a,Form:b.a,FormItem:m.a,InputNumber:g.a,Button:f.a,Message:c.a},data:function(){return{dialogVisible:!1,beatForm:{fenzi:0,fenmu:0},rules:{fenzi:[{required:!0,message:"请输入分子,且必须为正整数",trigger:"blur",validator:w}],fenmu:[{required:!0,message:"请输入分母,只能为2,4,8或16",trigger:"blur",validator:A}]}}},computed:{stageWidth:function(){return this.$store.getters.stageWidth}},methods:{toSubmitBeat:function(){var t=this;this.$refs.ruleForm.validate((function(e){e?(t.$store.dispatch("updateBeatForm",t.beatForm),t.dialogVisible=!1,t.toUpdateStage()):c.a.error("请全部填写完整并正确再提交")}))},toUpdateStage:function(){var t=this.$store.state.stageSize.width,e=this.$store.state.maxPitchRight;t>this.stageWidth&&this.$store.dispatch("updateMatter",15);while(e>this.stageWidth)this.$store.dispatch("updateMatter",15)},showBeatDialog:function(){this.beatForm=Object(h["a"])({},this.$store.state.beatForm),this.dialogVisible=!0}}},P=x,L=n("2877"),$=Object(L["a"])(P,l,u,!1,null,null,null),E=$.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:t.$style.container},[n("div",{class:t.$style.beat,on:{click:t.toShowBeat}},[t._v(" "+t._s(t.beatForm.fenzi)+"/"+t._s(t.beatForm.fenmu)+" ")]),n("BeatPiano"),n("div",{class:t.$style.right},[n("div",{class:t.$style.top},t._l(t.matter,(function(e){return n("div",{key:e,class:t.$style.matter,style:{width:t.beatWidth+"px"}},[t._v(t._s(e))])})),0),n("div",{ref:"stage",class:t.$style.stage,attrs:{id:"audioStage"}},[n("BeatStageBg"),n("BeatLine"),n("div",{ref:"drawStage",class:t.$style.drawStage,style:{width:t.stageWidth+"px",height:t.stageHeight+"px"},on:{mousedown:t.onMouseDown,mousemove:t.onMouseMove,mouseup:t.onMouseUp,mouseleave:t.onMouseUp}}),t._l(t.stagePitches,(function(e,r){return[n("div",{key:r,class:[t.$style.pitch,t.selectedPitch===r?t.$style.isActive:"",e.red?t.$style.isRed:""],style:{width:e.width+"px",height:e.height+"px",transform:"translate("+e.left+"px, "+e.top+"px)"},attrs:{slot:"reference","data-left":e.left,"data-top":e.top},on:{mousedown:function(e){return e.target!==e.currentTarget?null:t.onPitchMouseDown(e,r)},mouseup:function(e){return e.target!==e.currentTarget?null:t.onPitchMouseUp(e)}},slot:"reference"},[t._v(" "+t._s(e.hanzi)+" "),n("Arrow",{attrs:{direction:"left",pitch:e},on:{"move-end":function(e){return t.onArrowMoveEnd(e,r)}}}),n("Arrow",{attrs:{direction:"right",pitch:e},on:{"move-end":function(e){return t.onArrowMoveEnd(e,r)}}}),t.showList===r?n("div",{class:t.$style.list},[n("Card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("操作列表")])]),n("Button",{attrs:{type:"danger"},on:{click:function(e){return e.stopPropagation(),t.toDeletePitch(r)}}},[t._v("删除")])],1)],1):t._e()],1)]})),n("div",{ref:"sharp",class:t.$style.sharp}),1===this.$store.state.mode?n("PitchLine"):t._e()],2)])],1)},M=[],C=(n("a434"),n("a9e3"),n("b8e0"),n("a4c4")),k=n.n(C),O=n("0804"),F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.container},[n("div",{class:t.$style.left},[t._l(t.pitchList,(function(e){return[0===e.type&&1===e.show||0===e.type?n("div",{key:e.pitch,class:t.$style.white},[t._v(t._s(e.str))]):t._e()]}))],2),n("div",{class:t.$style.middle},[t._l(t.pitchList,(function(e){return[0===e.type?n("div",{key:e.pitch,class:t.$style.middleWhite}):n("div",{key:e.pitch,class:t.$style.middleBlack})]}))],2)])},I=[],R={name:"BeatPiano",data:function(){return{pitchList:O["a"]}}},j=R,D=n("7dff");function V(t){this["$style"]=D["default"].locals||D["default"]}var W=Object(L["a"])(j,F,I,!1,V,null,null),T=W.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.container,style:{width:t.stageWidth+"px"}},[n("div",{class:t.$style.row},[t._l(t.pitchList,(function(e){return[0===e.type?n("div",{key:e.pitch,class:t.$style.gray},[t._v(t._s(e.pitch))]):n("div",{key:e.pitch,class:t.$style.black},[t._v(t._s(e.pitch))])]}))],2),n("div",{class:t.$style.column},t._l(t.matter,(function(e){return n("div",{key:e,class:t.$style.fenziCon},t._l(t.beatForm.fenzi,(function(e){return n("div",{key:e,class:t.$style.fenzi},t._l(32/t.beatForm.fenmu,(function(e){return n("div",{key:e,class:t.$style.fenmu,style:{width:t.noteWidth+"px",height:t.stageHeight+"px"}})})),0)})),0)})),0)])},U=[],z={name:"BeatStageBg",components:{},data:function(){return{pitchList:O["a"]}},computed:{beatForm:function(){return this.$store.state.beatForm},stageWidth:function(){return this.$store.getters.stageWidth},matter:function(){return this.$store.state.matter},noteWidth:function(){return this.$store.state.noteWidth},stageHeight:function(){return this.$store.getters.stageHeight}}},G=z,Y=n("ea5d");function X(t){this["$style"]=Y["default"].locals||Y["default"]}var Z=Object(L["a"])(G,N,U,!1,X,null,null),H=Z.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.container,style:{transform:"translateX("+t.lineLeft+"px)",height:t.stageHeight+"px"},on:{mousedown:function(e){return e.stopPropagation(),t.onLineMouseDown(e)},mouseup:function(e){return e.stopPropagation(),t.onLineMouseUp(e)}}},[n("div",{class:t.$style.line},[n("span",{class:t.$style.innerSpan}),n("div",{class:t.$style.inner})])])},q=[],Q={name:"BeatLine",data:function(){return{isLineMouseDown:!1,left:0,startLeft:0,startX:0,eventListener:null}},mounted:function(){},computed:{isSynthetizing:function(){return this.$store.state.isSynthetizing},stageHeight:function(){return this.$store.getters.stageHeight},lineLeft:function(){return this.$store.state.lineLeft},playState:function(){return this.$store.state.playState}},methods:{onLineMouseDown:function(t){console.log("onLineMouseDown"),this.isSynthetizing?c.a.error("正在合成音频中,不能修改哦~"):this.playState!==O["b"].StatePlaying?(this.isLineMouseDown=!0,this.startLeft=this.lineLeft,this.startX=t.clientX,document.addEventListener("mousemove",this.onLineMouseMove),document.addEventListener("mouseleave",this.onLineMouseUp)):c.a.error("正在播放中, 不能修改哦~")},onLineMouseMove:function(t){if(this.isLineMouseDown){var e=t.clientX-this.startX,n=this.startLeft+e;this.left=n,this.$store.dispatch("changeStoreState",{lineLeft:n})}},onLineMouseUp:function(t){if(console.log("onLineMouseUp"),document.removeEventListener("mousemove",this.onLineMouseMove),document.removeEventListener("mouseleave",this.onLineMouseUp),this.isLineMouseDown){this.isLineMouseDown=!1;var e=t.clientX-this.startX,n=this.startLeft+e;this.$store.dispatch("changeStoreState",{lineLeft:n})}}}},K=Q,tt=n("abdb");function et(t){this["$style"]=tt["default"].locals||tt["default"]}var nt=Object(L["a"])(K,J,q,!1,et,null,null),rt=nt.exports,it=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{class:[t.$style.arrow,t.$style[t.direction],t.isActive?t.$style.isActive:""],on:{mouseup:function(e){return e.stopPropagation(),t.onArrowLeave(e)},mousedown:function(e){return e.preventDefault(),t.onArrowMouseDown(e)}}},[r("img",{attrs:{src:n("5712")}})])},ot=[],at={name:"Arrow",props:["direction","pitch"],data:function(){return{isActive:!1,moveArrowStart:null,moveArrowEnd:null}},components:{Message:c.a},computed:{isSynthetizing:function(){return this.$store.state.isSynthetizing},playState:function(){return this.$store.state.playState}},methods:{onArrowMouseDown:function(t){if(this.isSynthetizing)c.a.error("正在合成音频中,不能修改哦~");else if(this.playState!==O["b"].StatePlaying){document.addEventListener("mousemove",this.onArrowMouseMove),document.addEventListener("mouseleave",this.onArrowLeave);t.target;this.isActive=!0,this.moveArrowStart={width:this.pitch.width,left:this.pitch.left,top:this.pitch.top,clientX:t.clientX},console.log("moveArrowStart:",JSON.stringify(this.moveArrowStart))}else c.a.error("正在播放中, 不能修改哦~")},onArrowMouseMove:function(t){if(this.moveArrowStart){var e=this.$el.parentNode,n=t.clientX-this.moveArrowStart.clientX,r=this.moveArrowStart.top,i=0,o=0;"right"===this.direction?(o=this.moveArrowStart.left,i=Math.max(20,this.moveArrowStart.width+n)):"left"===this.direction&&(o=this.moveArrowStart.left+n,i=Math.max(20,this.moveArrowStart.width-n)),o<0&&(o=0),e.style.width="".concat(i,"px"),e.style.transform="translate(".concat(o,"px, ").concat(r,"px)"),this.moveArrowEnd={width:i,left:o,top:r,target:e,direction:this.direction}}},onArrowLeave:function(t){console.log("onArrowLeave"),this.moveArrowStart&&(this.moveArrowStart=null,document.removeEventListener("mousemove",this.onArrowMouseMove),document.removeEventListener("mouseleave",this.onArrowLeave),this.isActive=!1,this.$emit("move-end",Object(h["a"])({},this.moveArrowEnd)))}}},st=at,ct=n("67bb");function lt(t){this["$style"]=ct["default"].locals||ct["default"]}var ut=Object(L["a"])(st,it,ot,!1,lt,null,null),ht=ut.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"PitchLine",class:t.$style.PitchLine,style:{height:t.stageHeight+"px",width:t.stageWidth+"px"}},[n("svg",{attrs:{width:t.stageWidth+"px",height:t.stageHeight+"px",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:t.svgData,stroke:"white",fill:"transparent"}})])])},ft=[],pt=(n("b680"),n("a358")),gt=pt["a"],vt=function(t){return gt({method:"post",url:"/cgi-bin/v1/yan/synth/editor_synth",data:t})},mt=function(t){return gt({method:"post",url:"/cgi-bin/v1/yan/synth/editor_synth_status",data:{param_id:t}})},yt=function(t){return gt({method:"post",url:"/cgi-bin/v1/yan/synth/editor_synth_result",data:{task_id:t}})},bt=function(t){return gt({method:"post",url:"/cgi-bin/v1/yan/sdk_client/get_f0_data",data:t})},St=n("b233"),_t={name:"PitchLine",data:function(){return{svgData:"",filterF0Data:[]}},computed:{noteWidth:function(){return this.$store.state.noteWidth},bpm:function(){return this.$store.state.bpm},stageWidth:function(){return this.$store.getters.stageWidth},stageHeight:function(){return this.$store.getters.stageHeight},firstPitch:function(){return this.$store.getters.firstPitch},isStagePitchesChanged:function(){return this.$store.state.isStagePitchesChanged},noteHeight:function(){return this.$store.state.noteHeight},pitchWidth:function(){return 80*this.bpm*this.noteWidth/6e4},pitchList:function(){var t=this,e=this.$store.state.stagePitches;console.log("stagePitches:",e);var n=[];return e.forEach((function(e){var r=Object(St["d"])(e.width,t.noteWidth,t.bpm),i=t.firstPitch-e.top/e.height,o=Object(St["d"])(e.left,t.noteWidth,t.bpm),a={duration:r,pitch:i,singer:"luoxiang",startTime:o,pinyin:"la",hanzi:e.hanzi,tone_id:1};n.push(a)})),n}},mounted:function(){this.drawPitchLine()},methods:{drawPitchLine:function(){var t=this;return a(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.toGetPitchLineData();case 2:return n=e.sent,e.next=5,t.toHandleF0Data(n);case 5:r=e.sent,t.svgData=r;case 7:case"end":return e.stop()}}),e)})))()},toGetPitchLineData:function(){var t=this;return a(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.pitchList.length<=0)){e.next=3;break}return c.a.error("没有画音块，所以没音高线"),e.abrupt("return");case 3:return c.a.success("音高线正在生成中~"),e.next=6,bt({pitchList:t.pitchList});case 6:if(n=e.sent,r=n.data,console.log("getF0Data: ".concat(r)),0===r.ret_code){e.next=12;break}return c.a.error("请求音高线数据错误,错误信息:".concat(r.err_msg)),e.abrupt("return");case 12:return e.abrupt("return",r.data.f0_data);case 13:case"end":return e.stop()}}),e)})))()},toHandleF0Data:function(t){var e=[];console.log("f0Data:",t);for(var n=0;n<t.length;n+=1){var r=t[n];e.push({x:this.pitchWidth*n,y:parseFloat((this.firstPitch-parseFloat(r/100)).toFixed(2)).toFixed(2)*this.noteHeight})}this.filterF0Data=e,console.log("finalData:",e);var i="M ";return e.forEach((function(t){i+="".concat(t.x," ").concat(t.y,",")})),console.log("result:",i),i}}},wt=_t,At=n("692c");function xt(t){this["$style"]=At["default"].locals||At["default"]}var Pt=Object(L["a"])(wt,dt,ft,!1,xt,null,null),Lt=Pt.exports,$t={name:"BeatContainer",components:{Card:k.a,Button:f.a,Message:c.a,BeatPiano:T,BeatStageBg:H,Arrow:ht,BeatLine:rt,PitchLine:Lt},data:function(){return{pitchList:O["a"],isMouseDown:!1,startPos:null,endPos:null,stageOffset:null,movePitchStart:null,selectedPitch:-1,showList:-1}},computed:{stagePitches:function(){return this.$store.state.stagePitches},beatForm:function(){return this.$store.state.beatForm},noteWidth:function(){return this.$store.state.noteWidth},isSynthetizing:function(){return this.$store.state.isSynthetizing},stageWidth:function(){return this.$store.getters.stageWidth},matter:function(){return this.$store.state.matter},stageHeight:function(){return this.$store.getters.stageHeight},beatWidth:function(){return this.$store.getters.beatWidth},playState:function(){return this.$store.state.playState}},mounted:function(){var t=this;this.updateStageOffset(),this.$refs.stage.addEventListener("scroll",(function(){t.updateStageOffset()})),document.getElementById("audioStage").oncontextmenu=function(t){return!1}},methods:{checkPitchDuplicated:function(){for(var t=this.stagePitches,e=0;e<t.length;e++){var n=t[e];n.red=!1;for(var r=0;r<t.length;r++){var i=t[r];if(e!==r){var o=null,a=null;n.left<i.left?(o=n,a=i):(o=i,a=n);var s=o.left+o.width>a.left;s&&(n.red=s)}}}this.$emit("getPitches",t)},updateStageOffset:function(){var t=this.$refs.stage.scrollLeft,e=this.$refs.stage.scrollTop;this.stageOffset={scrollLeft:t,scrollTop:e}},toShowBeat:function(){this.isSynthetizing?c.a.error("正在合成音频中,不能修改哦~"):this.playState!==O["b"].StatePlaying?this.$emit("showBeat"):c.a.error("正在播放中, 不能修改哦~")},onPitchMouseDown:function(t,e){if(this.isSynthetizing)c.a.error("正在合成音频中,不能修改哦~");else if(this.playState!==O["b"].StatePlaying){var n=t.target;n.style.opacity=.8,this.toSelectPitch(e),2===t.button&&this.toPitchRight(e),this.movePitchStart={left:Number(n.dataset.left),top:Number(n.dataset.top),clientX:t.clientX,clientY:t.clientY,target:n,index:e},document.addEventListener("mousemove",this.onPitchMouseMove),document.addEventListener("mouseleave",this.onPitchMouseUp)}else c.a.error("正在播放中, 不能修改哦~")},onPitchMouseMove:function(t){if(this.movePitchStart){var e=this.movePitchStart.target,n=this.movePitchStart.left+(t.clientX-this.movePitchStart.clientX),r=this.movePitchStart.top+(t.clientY-this.movePitchStart.clientY);r<0&&(r=0),n<0&&(n=0),e.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e.dataset.left=n,e.dataset.top=r}},onPitchMouseUp:function(t){if(console.log("onPitchMouseUp"),this.movePitchStart){document.removeEventListener("mousemove",this.onPitchMouseMove),document.removeEventListener("mouseleave",this.onPitchMouseUp);var e=this.movePitchStart,n=e.target,r=e.index;t.target.style.opacity=1,this.movePitchStart=null;var i=parseInt(t.target.dataset.left,10),o=parseInt(t.target.dataset.top,10),a=this.stagePitches[r];a.left=Math.floor(i/this.noteWidth)*this.noteWidth,a.top=o-o%25,n.style.transform="translate(".concat(a.left,"px, ").concat(a.top,"px)"),n.dataset.left=a.left,n.dataset.top=a.top,this.checkPitchDuplicated()}},onMouseDown:function(t){if(this.isSynthetizing)c.a.error("正在合成音频中,不能修改哦~");else if(this.playState!==O["b"].StatePlaying){this.selectedPitch=-1,this.showList=-1,this.isMouseDown=!0;var e=this.$refs.stage.getBoundingClientRect();this.startPos={x:t.clientX+this.stageOffset.scrollLeft-e.left,y:t.clientY+this.stageOffset.scrollTop-e.top},this.$refs.sharp.style.left="".concat(this.startPos.x,"px"),this.$refs.sharp.style.top="".concat(this.startPos.y,"px"),this.$refs.sharp.style.width="1px",this.$refs.sharp.style.height="1px",this.$refs.sharp.style.display="block"}else c.a.error("正在播放中, 不能修改哦~")},onMouseMove:function(t){if(this.isMouseDown){var e=this.$refs.stage.getBoundingClientRect(),n={x:t.clientX+this.stageOffset.scrollLeft-e.left,y:t.clientY+this.stageOffset.scrollTop-e.top},r=n.x-this.startPos.x,i=n.y-this.startPos.y;r<0&&(this.$refs.sharp.style.left="".concat(n.x,"px")),i<0&&(this.$refs.sharp.style.top="".concat(n.y,"px")),this.$refs.sharp.style.width="".concat(Math.abs(r),"px"),this.$refs.sharp.style.height="".concat(Math.abs(i),"px"),this.toCheckOverStage(n.x)}},onMouseUp:function(t){if(this.isMouseDown){this.isMouseDown=!1;var e=this.$refs.stage.getBoundingClientRect();this.endPos={x:t.clientX+this.stageOffset.scrollLeft-e.left,y:t.clientY+this.stageOffset.scrollTop-e.top},this.$refs.sharp.style.display="none";var n=Math.min(this.startPos.y,this.endPos.y),r=n-n%25,i=Math.min(this.startPos.x,this.endPos.x),o=Math.floor(i/this.noteWidth)*this.noteWidth,a=Math.abs(this.startPos.x-this.endPos.x),s=Math.max(Math.ceil(a/this.noteWidth)*this.noteWidth,20),c="啦";this.addOnePitch({width:s,height:25,left:o,top:r,hanzi:c}),this.toCheckOverStage(this.endPos.x)}},addOnePitch:function(t){var e=t.width,n=t.height,r=t.left,i=t.top,o=t.hanzi;e>25&&(console.log("addOnePitch: width:".concat(e,", height: ").concat(n,", left: ").concat(r,", top: ").concat(i,", hanzi: ").concat(o)),this.stagePitches.push({width:e,height:n,left:r,top:i,hanzi:o,red:!1}),this.selectedPitch=this.stagePitches.length-1),this.checkPitchDuplicated(),this.checkPitchesOverStage()},onArrowMoveEnd:function(t,e){var n=t.width,r=t.left,i=t.top,o=t.target,a=t.direction,s=this.stagePitches[e];s.left=Math.floor(r/this.noteWidth)*this.noteWidth,s.top=i,s.width="left"===a?Math.ceil(n/this.noteWidth)*this.noteWidth:Math.floor(n/this.noteWidth)*this.noteWidth,o.style.transform="translate(".concat(s.left,"px, ").concat(s.top,"px)"),o.style.width="".concat(s.width,"px"),this.checkPitchDuplicated()},toSelectPitch:function(t){this.selectedPitch=t},toPitchRight:function(t){this.selectedPitch=t,this.showList=t},toDeletePitch:function(t){this.stagePitches.splice(t,1),this.showList=-1,this.checkPitchDuplicated()},toCheckOverStage:function(t){t+100>=this.stageWidth&&this.$store.dispatch("updateMatter",15)},checkPitchesOverStage:function(){var t=this,e=0;this.stagePitches.forEach((function(n){var r=n.left+n.width;e=Math.max(e,r),t.$store.dispatch("changeStoreState",{maxPitchRight:e})}))}}},Et=$t,Bt=n("990f");function Mt(t){this["$style"]=Bt["default"].locals||Bt["default"]}var Ct=Object(L["a"])(Et,B,M,!1,Mt,null,null),kt=Ct.exports,Ot=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{class:t.$style.header},[r("div",{class:t.$style.common},[r("div",{class:t.$style.but},[r("div",{class:[t.$style.mode,0===t.select?t.$style.isActive:""],on:{click:function(e){return t.selectMode(0)}}},[r("Icon",{staticClass:"el-icon-s-operation"})],1),r("div",{class:[t.$style.mode,1===t.select?t.$style.isActive:""],on:{click:function(e){return t.selectMode(1)}}},[r("Icon",{staticClass:"el-icon-sort-up"})],1)]),r("div",{class:t.$style.text},[t._v("音符/音高线模式")])]),r("div",{class:t.$style.common,on:{click:t.toPlay}},[r("div",{class:t.$style.but},[t.isPlaying?r("img",{class:t.$style.icon,attrs:{src:n("fc79")}}):r("img",{class:t.$style.icon,attrs:{src:n("7577")}})]),r("div",{class:t.$style.text},[t._v("播放控制")])]),r("div",{class:t.$style.common,on:{click:t.toGenerateAudio}},[r("div",{class:t.$style.but},[r("div",{class:t.$style.mode},[r("Icon",{staticClass:"el-icon-top-right"})],1)]),r("div",{class:t.$style.text},[t._v("生成音频")])]),r("div",{class:t.$style.common,on:{click:t.toClear}},[r("div",{class:t.$style.but},[r("div",{class:t.$style.mode},[r("Icon",{staticClass:"el-icon-refresh-left"})],1)]),r("div",{class:t.$style.text},[t._v("全部清除")])]),r("div",{class:t.$style.bpm},[t._v(t._s(t.bpm)+" BPM")])])},Ft=[],It=(n("aaa5"),n("a578")),Rt=n.n(It),jt={name:"BeatHeader",props:["isPlaying"],data:function(){return{}},computed:{bpm:function(){return this.$store.state.bpm},select:function(){return this.$store.state.mode}},components:{Icon:Rt.a,Button:f.a},methods:{toClear:function(){location.reload()},toPlay:function(){this.$emit("play")},selectMode:function(t){this.$store.dispatch("changeStoreState",{mode:t})},toGenerateAudio:function(){c.a.error("这里需要根据音高线去生成新的音频，暂时没做，先放着。")}}},Dt=jt,Vt=n("43ab");function Wt(t){this["$style"]=Vt["default"].locals||Vt["default"]}var Tt=Object(L["a"])(Dt,Ot,Ft,!1,Wt,null,null),Nt=Tt.exports,Ut=function(t){var e=t.url,n=t.startTime,r=void 0===n?0:n,i=t.onProgress,o=t.onPlay,a=t.onPause,s=t.onEnd;console.log("PlayAudio:",e,r);var c="my-audio",l=document.getElementById(c);return l&&l.parentNode.removeChild(l),l=document.createElement("audio"),l.controls=!0,l.src=e,l.id=c,l.type="audio/wav",l.style.display="none",l.addEventListener("timeupdate",(function(t){var e=t.target.currentTime;i&&i(e)})),l.addEventListener("ended",(function(t){s(t.target)})),l.addEventListener("play",(function(t){o(t.target)})),l.addEventListener("pause",(function(t){a(t.target)})),document.body.appendChild(l),l},zt={name:"AudioEditor",components:{Message:c.a,BeatSelector:E,BeatContainer:kt,BeatHeader:Nt},data:function(){return{pitches:[],timerId:0,audio:null,linePosition:null,playLine:{start:0,end:0,current:0},playStartTime:0}},mounted:function(){var t=this;this.storeStagePitchesWatcher=this.$store.watch((function(t){return t.stagePitches}),(function(e,n){console.log("watch store",n,e),t.$store.dispatch("changeStoreState",{isStagePitchesChanged:!0})}),{deep:!0})},destroyed:function(){this.storeStagePitchesWatcher()},computed:{noteWidth:function(){return this.$store.state.noteWidth},bpm:function(){return this.$store.state.bpm},isSynthetizing:function(){return this.$store.state.isSynthetizing},playState:function(){return this.$store.state.playState},isManualMovedLine:function(){return this.$store.state.lineLeft!==this.playLine.current},isStagePitchesChanged:function(){return this.$store.state.isStagePitchesChanged}},methods:{changePlayState:function(t){this.$store.dispatch("changeStoreState",{playState:t})},isNeedGenerate:function(){return!!this.isStagePitchesChanged},toPlay:function(){var t=this;return a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isSynthetizing){e.next=3;break}return c.a.error("正在合成音频中,请耐心等待~"),e.abrupt("return");case 3:console.log("Click play button, current state: ".concat(t.playState)),t.playState===O["b"].StateNone?(t.doPlay(!0),t.changePlayState(O["b"].StatePlaying)):t.playState===O["b"].StatePlaying?(t.audio.pause(),t.changePlayState(O["b"].StatePaused)):t.playState===O["b"].StatePaused?(t.isNeedGenerate()?t.doPlay(!0):t.isManualMovedLine?t.doPlay(!1):t.doPlay(!1,!0),t.changePlayState(O["b"].StatePlaying)):t.playState===O["b"].StateEnded&&(t.isNeedGenerate()?t.doPlay(!0):(t.isManualMovedLine,t.doPlay(!1)),t.changePlayState(O["b"].StatePlaying)),t.$store.dispatch("changeStoreState",{isStagePitchesChanged:!1});case 6:case"end":return e.stop()}}),e)})))()},doPlay:function(){var t=arguments,e=this;return a(regeneratorRuntime.mark((function n(){var r,i,o,a,s,c,l,u,h,d,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=!(t.length>0&&void 0!==t[0])||t[0],i=t.length>1&&void 0!==t[1]&&t[1],o=e.getLinePosition(),a=o.start,s=o.end,c=o.minStart,l=o.maxEnd,u=o.duration,console.log("doPlay generator:".concat(r,", isContinue:").concat(i,", start: ").concat(a,", end: ").concat(s,", minStart:").concat(c,", maxEnd: ").concat(l,", duration:").concat(u)),h=Math.max(0,(a-c)/(l-c)),d=h*u/1e3,console.log("duration:".concat(u,", startTime:").concat(d,", percent:").concat(h)),!r){n.next=18;break}return n.next=10,e.toSynthesize();case 10:f=n.sent,e.playLine={current:a,start:a,end:s},e.playStartTime=d,e.toPlayAudio(f),e.audio.currentTime=d,e.audio.play(),n.next=19;break;case 18:i?(console.log("play continue with start: ".concat(e.playStartTime)),e.audio.play()):(e.playLine={current:a,start:a,end:s},e.playStartTime=d,e.audio.currentTime=d,e.audio.play());case 19:case"end":return n.stop()}}),n)})))()},toPlayAudio:function(t){var e=this;clearInterval(this.timerId);var n=function t(n){e.playState===O["b"].StatePlaying&&window.requestAnimationFrame(t)};this.audio=Ut({url:t,onPlay:function(t){e.timerId=setInterval((function(){if(t.duration){var n=t.duration,r=n-e.playStartTime,i=1e3*r,o=e.playLine.end-e.playLine.start,a=i/16,s=o/a;e.playLine.current+=s,e.$store.dispatch("changeStoreState",{lineLeft:e.playLine.current})}}),16),window.requestAnimationFrame(n)},onPause:function(t){clearInterval(e.timerId)},onEnd:function(){clearInterval(e.timerId),e.changePlayState(O["b"].StateEnded),e.$store.dispatch("changeStoreState",{lineLeft:e.playLine.start}),e.playLine.current=e.playLine.start}})},toGetPictData:function(t){this.pitches=t},toHandlePitches:function(t){for(var e=this,n=this.$store.getters.firstPitch,r=0;r<t.length;r+=1)if(t[r].red)return;var i=[];return t.forEach((function(t){var r=Object(St["d"])(t.width,e.noteWidth,e.bpm),o=n-t.top/t.height,a=Object(St["d"])(t.left,e.noteWidth,e.bpm),s={duration:r,pitch:o,singer:"luoxiang",startTime:a,pinyin:"la",hanzi:t.hanzi,tone_id:1};i.push(s)})),i},getLinePosition:function(){var t=this,e=this.$store.state.lineLeft,n=1e7,r=0,i=1e9,o=0,a=0,s=0,c=0;this.pitches.forEach((function(l){var u=l.left+l.width;(l.left>=e||u>=e)&&(n=Math.min(n,l.left),r=Math.max(r,u)),i=Math.min(i,l.left),o=Math.max(o,u);var h=Object(St["d"])(l.width,t.noteWidth,t.bpm),d=Object(St["d"])(l.left,t.noteWidth,t.bpm);d<a&&(a=d),d>s&&(s=d,c=h)}));var l=s-a+c;return{start:n,end:r,minStart:i,maxEnd:o,duration:l}},toShowBeat:function(){this.$refs.BeatSelector.showBeatDialog()},toSynthesize:function(){var t=this;return a(regeneratorRuntime.mark((function e(){var n,r,i,o,a,s,l,u,h,d,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("toSynthesize"),e.next=3,t.toHandlePitches(t.pitches);case 3:if(n=e.sent,void 0!==n){e.next=8;break}return c.a.error("音符存在重叠, 请调整好~"),t.changePlayState(O["b"].StateNone),e.abrupt("return");case 8:if(n.length){e.next=11;break}return c.a.error("播放线后已经没有音符, 请画好音符再播放~"),e.abrupt("return");case 11:return t.$store.dispatch("changeStoreState",{isSynthetizing:!0}),r={pitchList:n,f0:[]},e.next=15,vt(r);case 15:if(i=e.sent,o=i.data,console.log("editorSynth:",o),0===o.ret_code){e.next=21;break}return c.a.error("合成失败, 错误信息:".concat(o.err_msg,", 请重试~")),e.abrupt("return");case 21:a=o.data.param_id,s=o.data.task_id,l="",u=0;case 25:if(!(u<10)){e.next=50;break}return e.next=28,mt(a);case 28:if(h=e.sent,d=h.data,0===d.ret_code){e.next=33;break}return c.a.error("查询合成状态失败, 错误信息: ".concat(d.err_msg)),e.abrupt("break",50);case 33:if(4!==d.data.status){e.next=44;break}return e.next=36,yt(s);case 36:if(f=e.sent,console.log("editorSynthResult:",d),0!==f.data.ret_code||2!==f.data.data.state){e.next=42;break}return l=f.data.data.online_url,c.a.success("音频合成成功~"),e.abrupt("break",50);case 42:e.next=45;break;case 44:c.a.success("算法努力合成音频中(".concat(O["c"][d.data.status],"%)"));case 45:return e.next=47,Object(St["f"])(3e3);case 47:u++,e.next=25;break;case 50:return t.$store.dispatch("changeStoreState",{isSynthetizing:!1}),e.abrupt("return",l);case 52:case"end":return e.stop()}}),e)})))()}}},Gt=zt,Yt=n("80bf");function Xt(t){this["$style"]=Yt["default"].locals||Yt["default"]}var Zt=Object(L["a"])(Gt,r,i,!1,Xt,null,null);e["default"]=Zt.exports},a434:function(t,e,n){"use strict";var r=n("23e7"),i=n("23cb"),o=n("a691"),a=n("50c4"),s=n("7b0b"),c=n("65f0"),l=n("8418"),u=n("1dde"),h=n("ae40"),d=u("splice"),f=h("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,g=Math.min,v=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d||!f},{splice:function(t,e){var n,r,u,h,d,f,y=s(this),b=a(y.length),S=i(t,b),_=arguments.length;if(0===_?n=r=0:1===_?(n=0,r=b-S):(n=_-2,r=g(p(o(e),0),b-S)),b+n-r>v)throw TypeError(m);for(u=c(y,r),h=0;h<r;h++)d=S+h,d in y&&l(u,h,y[d]);if(u.length=r,n<r){for(h=S;h<b-r;h++)d=h+r,f=h+n,d in y?y[f]=y[d]:delete y[f];for(h=b;h>b-r+n;h--)delete y[h-1]}else if(n>r)for(h=b-r;h>S;h--)d=h+r-1,f=h+n-1,d in y?y[f]=y[d]:delete y[f];for(h=0;h<n;h++)y[h+S]=arguments[h+2];return y.length=b-r+n,u}})},a4c4:function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=103)}({0:function(t,e,n){"use strict";function r(t,e,n,r,i,o,a,s){var c,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),a?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=c):i&&(c=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var h=l.beforeCreate;l.beforeCreate=h?[].concat(h,c):[c]}return{exports:t,options:l}}n.d(e,"a",(function(){return r}))},103:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"el-card",class:t.shadow?"is-"+t.shadow+"-shadow":"is-always-shadow"},[t.$slots.header||t.header?n("div",{staticClass:"el-card__header"},[t._t("header",[t._v(t._s(t.header))])],2):t._e(),n("div",{staticClass:"el-card__body",style:t.bodyStyle},[t._t("default")],2)])},i=[];r._withStripped=!0;var o={name:"ElCard",props:{header:{},bodyStyle:{},shadow:{type:String}}},a=o,s=n(0),c=Object(s["a"])(a,r,i,!1,null,null,null);c.options.__file="packages/card/src/main.vue";var l=c.exports;l.install=function(t){t.component(l.name,l)};e["default"]=l}})},a578:function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=109)}({0:function(t,e,n){"use strict";function r(t,e,n,r,i,o,a,s){var c,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),a?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=c):i&&(c=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var h=l.beforeCreate;l.beforeCreate=h?[].concat(h,c):[c]}return{exports:t,options:l}}n.d(e,"a",(function(){return r}))},109:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("i",{class:"el-icon-"+t.name})},i=[];r._withStripped=!0;var o={name:"ElIcon",props:{name:String}},a=o,s=n(0),c=Object(s["a"])(a,r,i,!1,null,null,null);c.options.__file="packages/icon/src/icon.vue";var l=c.exports;l.install=function(t){t.component(l.name,l)};e["default"]=l}})},a9e3:function(t,e,n){"use strict";var r=n("83ab"),i=n("da84"),o=n("94ca"),a=n("6eeb"),s=n("5135"),c=n("c6b6"),l=n("7156"),u=n("c04e"),h=n("d039"),d=n("7c73"),f=n("241c").f,p=n("06cf").f,g=n("9bf2").f,v=n("58a8").trim,m="Number",y=i[m],b=y.prototype,S=c(d(b))==m,_=function(t){var e,n,r,i,o,a,s,c,l=u(t,!1);if("string"==typeof l&&l.length>2)if(l=v(l),e=l.charCodeAt(0),43===e||45===e){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+l}for(o=l.slice(2),a=o.length,s=0;s<a;s++)if(c=o.charCodeAt(s),c<48||c>i)return NaN;return parseInt(o,r)}return+l};if(o(m,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var w,A=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof A&&(S?h((function(){b.valueOf.call(n)})):c(n)!=m)?l(new y(_(e)),n,A):_(e)},x=r?f(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),P=0;x.length>P;P++)s(y,w=x[P])&&!s(A,w)&&g(A,w,p(y,w));A.prototype=b,b.constructor=A,a(i,m,A)}},aaa5:function(t,e,n){},abdb:function(t,e,n){"use strict";var r=n("2705"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},b680:function(t,e,n){"use strict";var r=n("23e7"),i=n("a691"),o=n("408a"),a=n("1148"),s=n("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,n){return 0===e?n:e%2===1?u(t,e-1,n*t):u(t*t,e/2,n)},h=function(t){var e=0,n=t;while(n>=4096)e+=12,n/=4096;while(n>=2)e+=1,n/=2;return e},d=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));r({target:"Number",proto:!0,forced:d},{toFixed:function(t){var e,n,r,s,c=o(this),d=i(t),f=[0,0,0,0,0,0],p="",g="0",v=function(t,e){var n=-1,r=e;while(++n<6)r+=t*f[n],f[n]=r%1e7,r=l(r/1e7)},m=function(t){var e=6,n=0;while(--e>=0)n+=f[e],f[e]=l(n/t),n=n%t*1e7},y=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==f[t]){var n=String(f[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e};if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(e=h(c*u(2,69,1))-69,n=e<0?c*u(2,-e,1):c/u(2,e,1),n*=4503599627370496,e=52-e,e>0){v(0,n),r=d;while(r>=7)v(1e7,0),r-=7;v(u(10,r,1),0),r=e-1;while(r>=23)m(1<<23),r-=23;m(1<<r),v(1,1),m(2),g=y()}else v(0,n),v(1<<-e,0),g=y()+a.call("0",d);return d>0?(s=g.length,g=p+(s<=d?"0."+a.call("0",d-s)+g:g.slice(0,s-d)+"."+g.slice(s-d))):g=p+g,g}})},b8e0:function(t,e,n){},bf7c:function(t,e,n){t.exports={container:"BeatStageBg_container_1eASZ",row:"BeatStageBg_row_13Laq",gray:"BeatStageBg_gray_2lgEj",black:"BeatStageBg_black_15Jq9",fenziCon:"BeatStageBg_fenziCon_2nhxI",column:"BeatStageBg_column_1dlnm",fenzi:"BeatStageBg_fenzi_2g8XQ",fenmu:"BeatStageBg_fenmu_3GURu"}},caad:function(t,e,n){"use strict";var r=n("23e7"),i=n("4d64").includes,o=n("44d2"),a=n("ae40"),s=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:!s},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},d8a6:function(t,e,n){t.exports={container:"BeatContainer_container_2TcbY",right:"BeatContainer_right_DzYQJ",top:"BeatContainer_top_2EYzS",stage:"BeatContainer_stage_15-iQ",matter:"BeatContainer_matter_3UfYC",drawStage:"BeatContainer_drawStage_3tOsg",beat:"BeatContainer_beat_30sC3",pitch:"BeatContainer_pitch_1pSFM",isActive:"BeatContainer_isActive_2UXvs",isRed:"BeatContainer_isRed_1GRtZ",list:"BeatContainer_list_3QVqk",sharp:"BeatContainer_sharp_2NR36"}},ea5d:function(t,e,n){"use strict";var r=n("bf7c"),i=n.n(r);n.d(e,"default",(function(){return i.a}))},eedf:function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=97)}({0:function(t,e,n){"use strict";function r(t,e,n,r,i,o,a,s){var c,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),a?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=c):i&&(c=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var h=l.beforeCreate;l.beforeCreate=h?[].concat(h,c):[c]}return{exports:t,options:l}}n.d(e,"a",(function(){return r}))},97:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"el-button",class:[t.type?"el-button--"+t.type:"",t.buttonSize?"el-button--"+t.buttonSize:"",{"is-disabled":t.buttonDisabled,"is-loading":t.loading,"is-plain":t.plain,"is-round":t.round,"is-circle":t.circle}],attrs:{disabled:t.buttonDisabled||t.loading,autofocus:t.autofocus,type:t.nativeType},on:{click:t.handleClick}},[t.loading?n("i",{staticClass:"el-icon-loading"}):t._e(),t.icon&&!t.loading?n("i",{class:t.icon}):t._e(),t.$slots.default?n("span",[t._t("default")],2):t._e()])},i=[];r._withStripped=!0;var o={name:"ElButton",inject:{elForm:{default:""},elFormItem:{default:""}},props:{type:{type:String,default:"default"},size:String,icon:{type:String,default:""},nativeType:{type:String,default:"button"},loading:Boolean,disabled:Boolean,plain:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},buttonSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},buttonDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},methods:{handleClick:function(t){this.$emit("click",t)}}},a=o,s=n(0),c=Object(s["a"])(a,r,i,!1,null,null,null);c.options.__file="packages/button/src/button.vue";var l=c.exports;l.install=function(t){t.component(l.name,l)};e["default"]=l}})},fc79:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWBAMAAAA2mnEIAAAAD1BMVEUAAAAsq/8srf8sq/8sq/9erwomAAAABHRSTlMA+YXza8bhbQAAACVJREFUGNNjQAPKCgxMRlC2iAADoyOU7eLAwOIyhNkwvyD8iAoAe4MOe4zipr4AAAAASUVORK5CYII="}}]);
//# sourceMappingURL=chunk-00a64d95.1d9fc1c5.js.map